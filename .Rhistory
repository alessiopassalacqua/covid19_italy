covid_italy_sum <- read.csv("https://raw.githubusercontent.com/pcm-dpc/COVID-19/master/dati-andamento-nazionale/dpc-covid19-ita-andamento-nazionale.csv")
# covid x province
covid_itpro <- read.csv("https://raw.githubusercontent.com/pcm-dpc/COVID-19/master/dati-province/dpc-covid19-ita-province.csv")
covid_italy %>%
mutate(data = date(data)) %>%
mutate(regione = as.character(denominazione_regione))# %>%
select(-denominazione_regione,
-stato,
-codice_regione,
-lat,
-long) %>%
mutate(regione = ifelse(.$regione == "Trento","Trentino-Alto Adige",.$regione))%>%
mutate( regione = ifelse(.$regione == "Bolzano","Trentino-Alto Adige",.$regione)) %>%
mutate(regione = ifelse(.$regione == "P.A. Trento","Trentino-Alto Adige",.$regione))%>%
mutate( regione = ifelse(.$regione == "P.A. Bolzano","Trentino-Alto Adige",.$regione)) %>%
group_by(regione,data) %>%
summarize_all(~sum(.)) %>%
ungroup(regione) %>%
arrange(desc(data),desc(totale_casi))
covid_italy %>%
mutate(data = date(data)) %>%
mutate(regione = as.character(denominazione_regione)) # %>%
covid_italy %>%
mutate(data = date(data)) %>%
mutate(regione = as.character(denominazione_regione))  %>%
select(-denominazione_regione,
-stato,
-codice_regione,
-lat,
-long)# %>%
covid_italy %>%
mutate(data = date(data)) %>%
mutate(regione = as.character(denominazione_regione))  %>%
select(-denominazione_regione,
-stato,
-codice_regione,
-lat,
-long) %>%
mutate(regione = ifelse(.$regione == "Trento","Trentino-Alto Adige",.$regione))%>%
mutate( regione = ifelse(.$regione == "Bolzano","Trentino-Alto Adige",.$regione)) %>%
mutate(regione = ifelse(.$regione == "P.A. Trento","Trentino-Alto Adige",.$regione))%>%
mutate( regione = ifelse(.$regione == "P.A. Bolzano","Trentino-Alto Adige",.$regione)) %>%
group_by(regione,data)# %>%
covid_italy %>%
mutate(data = date(data)) %>%
mutate(regione = as.character(denominazione_regione))  %>%
select(-denominazione_regione,
-stato,
-codice_regione,
-lat,
-long) %>%
mutate(regione = ifelse(.$regione == "Trento","Trentino-Alto Adige",.$regione))%>%
mutate( regione = ifelse(.$regione == "Bolzano","Trentino-Alto Adige",.$regione)) %>%
mutate(regione = ifelse(.$regione == "P.A. Trento","Trentino-Alto Adige",.$regione))%>%
mutate( regione = ifelse(.$regione == "P.A. Bolzano","Trentino-Alto Adige",.$regione)) %>%
group_by(regione,data) %>%
summarize_all(~sum(.)) # %>%
covid_italy %>%
mutate(data = date(data)) %>%
mutate(regione = as.character(denominazione_regione))  %>%
select(-denominazione_regione,
-stato,
-codice_regione,
-lat,
-long) %>%
mutate(regione = ifelse(.$regione == "Trento","Trentino-Alto Adige",.$regione))%>%
mutate( regione = ifelse(.$regione == "Bolzano","Trentino-Alto Adige",.$regione)) %>%
mutate(regione = ifelse(.$regione == "P.A. Trento","Trentino-Alto Adige",.$regione))%>%
mutate( regione = ifelse(.$regione == "P.A. Bolzano","Trentino-Alto Adige",.$regione)) %>%
group_by(regione,data) %>%
glimpse)
covid_italy %>%
mutate(data = date(data)) %>%
mutate(regione = as.character(denominazione_regione))  %>%
select(-denominazione_regione,
-stato,
-codice_regione,
-lat,
-long) %>%
mutate(regione = ifelse(.$regione == "Trento","Trentino-Alto Adige",.$regione))%>%
mutate( regione = ifelse(.$regione == "Bolzano","Trentino-Alto Adige",.$regione)) %>%
mutate(regione = ifelse(.$regione == "P.A. Trento","Trentino-Alto Adige",.$regione))%>%
mutate( regione = ifelse(.$regione == "P.A. Bolzano","Trentino-Alto Adige",.$regione)) %>%
group_by(regione,data) %>%
glimpse()
covid_italy %<>%
mutate(data = date(data)) %>%
mutate(regione = as.character(denominazione_regione)) %>%
select(-denominazione_regione,
-stato,
-codice_regione,
-lat,
-long,
-note_it,
-note_en) %>%
mutate(regione = ifelse(.$regione == "Trento","Trentino-Alto Adige",.$regione))%>%
mutate( regione = ifelse(.$regione == "Bolzano","Trentino-Alto Adige",.$regione)) %>%
mutate(regione = ifelse(.$regione == "P.A. Trento","Trentino-Alto Adige",.$regione))%>%
mutate( regione = ifelse(.$regione == "P.A. Bolzano","Trentino-Alto Adige",.$regione)) %>%
group_by(regione,data) %>%
summarize_all(~sum(.)) %>%
ungroup(regione) %>%
arrange(desc(data),desc(totale_casi))
knitr::opts_chunk$set(warning=FALSE, message=FALSE)
library(dplyr)
library(drc)
library(lubridate)
library(ggplot2)
library(scales)
theme_set(theme_bw())
# get the data
covid_italy_sum <- read.csv("https://raw.githubusercontent.com/pcm-dpc/COVID-19/master/dati-andamento-nazionale/dpc-covid19-ita-andamento-nazionale.csv")
maxrange <- 60
x <-  1:maxrange
nn <- 0   # test
cov_tot <-  rep(NA,maxrange)
gg <-  length(covid_italy_sum$totale_casi)
cov_tot[1:(gg-nn)]    <- covid_italy_sum$totale_casi[1:(gg-nn)]
xy <- data.frame(x=x,y=cov_tot)
# fitting logistico
model <- drm(y ~ x, fct = L.3(), data = xy[1:(gg-nn),])
summary(model)
# prediction
xy_fit <-
predict(model,xy,interval = 'confidence')  %>%
as.data.frame()
# plot fitting
nomodel <- rep(NA,maxrange)
nomodel[(gg-nn+1):gg] <- covid_italy_sum$totale_casi[(gg-nn+1):gg]
y_text <- 40000
nuovicasi <- rep(NA,maxrange)
nuovicasi[1:gg] <- (covid_italy_sum$totale_casi - lag( covid_italy_sum$totale_casi ) )*10
ggplot(xy_fit,aes(x=1:maxrange,y=Prediction))  +
geom_line() +
geom_point(colour="blue",aes(y=xy$y)) +
#  geom_point(colour="red",aes(y=nomodel),shape=15,size=2) +
geom_line(aes(y = Lower), color = "red", linetype = "dashed")+
geom_line(aes(y = Upper), color = "red", linetype = "dashed")+
geom_line(aes(y = nuovicasi),color = 'orange', alpha = .5) +
geom_area(aes(y = nuovicasi),fill = 'orange', alpha = .05) +
#-- ITALY
annotate(geom = "text", x = 5, y = 74000+y_text,
label = "Training data", hjust = 0) +
annotate("pointrange", x = 3.5, y = 74000+y_text, ymin = 73500+y_text,
ymax = 73500+y_text,colour = "blue", size = 0.7)+
#-- FIT
annotate(geom = "text", x = 5, y = 67000+y_text,
label = "Fit logistico", hjust = 0) +
annotate(geom = "segment", x = 2.5,xend = 4,
y = 67000+y_text,yend=67000+y_text) +
#-- CONF
annotate(geom = "text", x = 5, y = 60000+y_text,
label = "Intervallo di confidenza 95%", hjust = 0) +
annotate(geom = "segment", x = 2.5,xend = 3,
y = 60000+y_text,yend=60000+y_text, colour="red") +
annotate(geom = "segment", x = 3.5,xend = 4,
y = 60000+y_text,yend=60000+y_text, colour="red") +
#-- NUOVI CASI
annotate(geom = "text", x = 5, y = 53000+y_text,
label = "Nuovi Casi", hjust = 0) +
annotate(geom = "segment", x = 2.5,xend = 4,
y = 53000+y_text,yend=53000+y_text,color="orange",size=1.1) +
#-- Test
#  annotate(geom = "text", x = 5, y = 46000+y_text,
#           label = "Test data", hjust = 0) +
#  annotate(geom="rect",xmin=3, xmax=3.6, ymin=44000+y_text , ymax=47000+y_text, color="red", fill="red") +
#-- Restoacasa
geom_label( aes( x=50, y=10000, label="#iorestoacasa"),
color="black",
size=5 , fontface="bold" )+
scale_y_continuous(
label = comma_format(big.mark = ".", decimal.mark = ","),
"Totale Positivi",
sec.axis = sec_axis(~ . / 10, name = "Nuovi casi")  ) +
#-- #iorestoacasa
labs(title = "Crescita contagiati Coronavirus Italia ",
subtitle = paste0("Previsione curva di crescita - Aggiornamento del ", Sys.Date() ),
caption = "Dati: Protezione Civile",
x = "Giorni (giorno 1 = 24 Febbraio)",
y = "Totale Positivi")
knitr::opts_chunk$set(warning=FALSE, message=FALSE)
library(dplyr)
library(lubridate)
library(ggplot2)
library(magrittr)
theme_set(theme_bw())
covid_italy <- read.csv("https://raw.githubusercontent.com/pcm-dpc/COVID-19/master/dati-regioni/dpc-covid19-ita-regioni.csv")
covid_italy %>%
glimpse()
covid_italy %<>%
mutate(data = date(data)) %>%
mutate(regione = as.character(denominazione_regione)) %>%
select(-denominazione_regione,
-stato,
-codice_regione,
-lat,
-long,
-note_it,
-note_en) %>%
mutate(regione = ifelse(.$regione == "Trento","Trentino-Alto Adige",.$regione))%>%
mutate( regione = ifelse(.$regione == "Bolzano","Trentino-Alto Adige",.$regione)) %>%
mutate(regione = ifelse(.$regione == "P.A. Trento","Trentino-Alto Adige",.$regione))%>%
mutate( regione = ifelse(.$regione == "P.A. Bolzano","Trentino-Alto Adige",.$regione)) %>%
group_by(regione,data) %>%
summarize_all(~sum(.)) %>%
ungroup(regione) %>%
arrange(desc(data),desc(totale_casi))
library(tidyr)
covid_byregion %>%
gather(gr,nuovi_casi,-data)  %>%
ggplot(aes(x=data,y=nuovi_casi,colour=gr)) +
geom_line(aes(colour=gr))  +
scale_y_continuous(
label = comma_format(big.mark = ".", decimal.mark = ","),
"Totale Positivi",
sec.axis = sec_axis(~ . / 10, name = "Nuovi casi")  ) +
#-- #iorestoacasa
labs(title = "Crescita contagiati Coronavirus Italia ",
subtitle = paste0("Previsione curva di crescita - Aggiornamento del ", Sys.Date() ),
caption = "Dati: Protezione Civile",
x = "Giorni (giorno 1 = 24 Febbraio)",
y = "Totale Positivi")
knitr::opts_chunk$set(warning=FALSE, message=FALSE)
library(dplyr)
library(lubridate)
library(ggplot2)
library(magrittr)
theme_set(theme_bw())
covid_italy <- read.csv("https://raw.githubusercontent.com/pcm-dpc/COVID-19/master/dati-regioni/dpc-covid19-ita-regioni.csv")
covid_italy %>%
glimpse()
covid_italy %<>%
mutate(data = date(data)) %>%
mutate(regione = as.character(denominazione_regione)) %>%
select(-denominazione_regione,
-stato,
-codice_regione,
-lat,
-long,
-note_it,
-note_en) %>%
mutate(regione = ifelse(.$regione == "Trento","Trentino-Alto Adige",.$regione))%>%
mutate( regione = ifelse(.$regione == "Bolzano","Trentino-Alto Adige",.$regione)) %>%
mutate(regione = ifelse(.$regione == "P.A. Trento","Trentino-Alto Adige",.$regione))%>%
mutate( regione = ifelse(.$regione == "P.A. Bolzano","Trentino-Alto Adige",.$regione)) %>%
group_by(regione,data) %>%
summarize_all(~sum(.)) %>%
ungroup(regione) %>%
arrange(desc(data),desc(totale_casi))
library(tidyr)
covid_byregion %>%
gather(gr,nuovi_casi,-data)  %>%
ggplot(aes(x=data,y=nuovi_casi,colour=gr)) +
geom_line(aes(colour=gr))  +
scale_y_continuous(
label = comma_format(big.mark = ".", decimal.mark = ","),
"Totale Positivi",
sec.axis = sec_axis(~ . / 10, name = "Nuovi casi")  ) +
#-- #iorestoacasa
labs(title = "Crescita contagiati Coronavirus Italia ",
subtitle = paste0("Previsione curva di crescita - Aggiornamento del ", Sys.Date() ),
caption = "Dati: Protezione Civile",
x = "Giorni (giorno 1 = 24 Febbraio)",
y = "Totale Positivi")
covid_byregion <-
covid_nord_ovest %>%
left_join(covid_nord_est) %>%
left_join(covid_centro) %>%
left_join(covid_sud_isole) %>%
select(data,nuovi_casi_no,nuovi_casi_ne,nuovi_casi_si,nuovi_casi_ce)
knitr::opts_chunk$set(warning=FALSE, message=FALSE)
library(dplyr)
library(lubridate)
library(ggplot2)
library(magrittr)
theme_set(theme_bw())
covid_italy <- read.csv("https://raw.githubusercontent.com/pcm-dpc/COVID-19/master/dati-regioni/dpc-covid19-ita-regioni.csv")
covid_italy %>%
glimpse()
covid_italy %<>%
mutate(data = date(data)) %>%
mutate(regione = as.character(denominazione_regione)) %>%
select(-denominazione_regione,
-stato,
-codice_regione,
-lat,
-long,
-note_it,
-note_en) %>%
mutate(regione = ifelse(.$regione == "Trento","Trentino-Alto Adige",.$regione))%>%
mutate( regione = ifelse(.$regione == "Bolzano","Trentino-Alto Adige",.$regione)) %>%
mutate(regione = ifelse(.$regione == "P.A. Trento","Trentino-Alto Adige",.$regione))%>%
mutate( regione = ifelse(.$regione == "P.A. Bolzano","Trentino-Alto Adige",.$regione)) %>%
group_by(regione,data) %>%
summarize_all(~sum(.)) %>%
ungroup(regione) %>%
arrange(desc(data),desc(totale_casi))
covid_byregion <-
covid_nord_ovest %>%
left_join(covid_nord_est) %>%
left_join(covid_centro) %>%
left_join(covid_sud_isole) %>%
select(data,nuovi_casi_no,nuovi_casi_ne,nuovi_casi_si,nuovi_casi_ce)
knitr::opts_chunk$set(warning=FALSE, message=FALSE)
library(dplyr)
library(lubridate)
library(ggplot2)
library(magrittr)
theme_set(theme_bw())
covid_italy <- read.csv("https://raw.githubusercontent.com/pcm-dpc/COVID-19/master/dati-regioni/dpc-covid19-ita-regioni.csv")
covid_italy %>%
glimpse()
covid_italy %<>%
mutate(data = date(data)) %>%
mutate(regione = as.character(denominazione_regione)) %>%
select(-denominazione_regione,
-stato,
-codice_regione,
-lat,
-long,
-note_it,
-note_en) %>%
mutate(regione = ifelse(.$regione == "Trento","Trentino-Alto Adige",.$regione))%>%
mutate( regione = ifelse(.$regione == "Bolzano","Trentino-Alto Adige",.$regione)) %>%
mutate(regione = ifelse(.$regione == "P.A. Trento","Trentino-Alto Adige",.$regione))%>%
mutate( regione = ifelse(.$regione == "P.A. Bolzano","Trentino-Alto Adige",.$regione)) %>%
group_by(regione,data) %>%
summarize_all(~sum(.)) %>%
ungroup(regione) %>%
arrange(desc(data),desc(totale_casi))
covid_italy %<>%
mutate(data = date(data)) %>%
mutate(regione = as.character(denominazione_regione)) %>%
select(-denominazione_regione,
-stato,
-codice_regione,
-lat,
-long,
-note_it,
-note_en) %>%
mutate(regione = ifelse(.$regione == "Trento","Trentino-Alto Adige",.$regione))%>%
mutate( regione = ifelse(.$regione == "Bolzano","Trentino-Alto Adige",.$regione)) %>%
mutate(regione = ifelse(.$regione == "P.A. Trento","Trentino-Alto Adige",.$regione))%>%
mutate( regione = ifelse(.$regione == "P.A. Bolzano","Trentino-Alto Adige",.$regione)) %>%
group_by(regione,data) %>%
summarize_all(~sum(.)) %>%
ungroup(regione) %>%
arrange(desc(data),desc(totale_casi))
knitr::opts_chunk$set(warning=FALSE, message=FALSE)
library(dplyr)
library(lubridate)
library(ggplot2)
library(magrittr)
theme_set(theme_bw())
covid_italy <- read.csv("https://raw.githubusercontent.com/pcm-dpc/COVID-19/master/dati-regioni/dpc-covid19-ita-regioni.csv")
covid_italy %>%
glimpse()
covid_italy %<>%
mutate(data = date(data)) %>%
mutate(regione = as.character(denominazione_regione)) %>%
select(-denominazione_regione,
-stato,
-codice_regione,
-lat,
-long,
-note_it,
-note_en) %>%
mutate(regione = ifelse(.$regione == "Trento","Trentino-Alto Adige",.$regione))%>%
mutate( regione = ifelse(.$regione == "Bolzano","Trentino-Alto Adige",.$regione)) %>%
mutate(regione = ifelse(.$regione == "P.A. Trento","Trentino-Alto Adige",.$regione))%>%
mutate( regione = ifelse(.$regione == "P.A. Bolzano","Trentino-Alto Adige",.$regione)) %>%
group_by(regione,data) %>%
summarize_all(~sum(.)) %>%
ungroup(regione) %>%
arrange(desc(data),desc(totale_casi))
covid_italy %<>%
mutate(data = date(data)) %>%
mutate(regione = as.character(denominazione_regione)) %>%
select(-denominazione_regione,
-stato,
-codice_regione,
-lat,
-long,
-note_it,
-note_en) %>%
glimpse()
covid_italy %>%
mutate(data = date(data)) %>%
mutate(regione = as.character(denominazione_regione)) %>%
select(-denominazione_regione,
-stato,
-codice_regione,
-lat,
-long) %>%
glimpse()
covid_italy %>%
glimpse()
mutate(data = date(data)) %>%
mutate(regione = as.character(denominazione_regione)) %>%
select(-denominazione_regione,
-stato,
-codice_regione,
-lat,
-long,
-note_it,
-note_en) %>%
glimpse()
covid_italy %>%
mutate(data = date(data)) %>%
mutate(regione = as.character(denominazione_regione)) %>%
select(-denominazione_regione,
-stato,
-codice_regione,
-lat,
-long,
-note_it,
-note_en) %>%
glimpse()
covid_italy %>%
glimpse()
covid_italy %>%
#  glimpse()
mutate(data = date(data)) %>%
mutate(regione = as.character(denominazione_regione)) %>%
select(-denominazione_regione,
-stato,
-codice_regione,
-lat,
-long,
-note_it,
-note_en) %>%
glimpse()
covid_italy <- read.csv("https://raw.githubusercontent.com/pcm-dpc/COVID-19/master/dati-regioni/dpc-covid19-ita-regioni.csv")
covid_italy %<>%
mutate(data = date(data)) %>%
mutate(regione = as.character(denominazione_regione))  %>%
select(-denominazione_regione,
-stato,
-codice_regione,
-lat,
-long,
-note_it,
-note_en) %>%
mutate(regione = ifelse(.$regione == "Trento","Trentino-Alto Adige",.$regione))%>%
mutate( regione = ifelse(.$regione == "Bolzano","Trentino-Alto Adige",.$regione)) %>%
mutate(regione = ifelse(.$regione == "P.A. Trento","Trentino-Alto Adige",.$regione))%>%
mutate( regione = ifelse(.$regione == "P.A. Bolzano","Trentino-Alto Adige",.$regione)) %>%
group_by(regione,data) %>%
summarize_all(~sum(.))  %>%
ungroup(regione) %>%
arrange(desc(data),desc(totale_casi))
knitr::opts_chunk$set(warning=FALSE, message=FALSE)
library(dplyr)
library(lubridate)
library(ggplot2)
library(magrittr)
theme_set(theme_bw())
covid_italy <- read.csv("https://raw.githubusercontent.com/pcm-dpc/COVID-19/master/dati-regioni/dpc-covid19-ita-regioni.csv")
covid_italy %>%
glimpse()
library(flexdashboard)
library(ggplot2)
library(highcharter)
library(gtrendsR)
library(lubridate)
library(dplyr)
library(stringr)
library(viridisLite)
library(DT)
library(magrittr)
library(dygraphs)
library(plotly)
library(xts)
library(viridis)
library(leaflet)
library(tmap)
thm <-
hc_theme(
colors = c("#1a6ecc", "#434348", "#90ed7d"),
chart = list(
backgroundColor = "transparent",
style = list(fontFamily = "Source Sans Pro")),
xAxis = list( gridLineWidth = 1)
)
confirmed_color <- "purple"
active_color <- "#1f77b4"
recovered_color <- "forestgreen"
death_color <- "red"
# covid x regioni
covid_italy <- read.csv("https://raw.githubusercontent.com/pcm-dpc/COVID-19/master/dati-regioni/dpc-covid19-ita-regioni.csv")
# covid nazionale
covid_italy_sum <- read.csv("https://raw.githubusercontent.com/pcm-dpc/COVID-19/master/dati-andamento-nazionale/dpc-covid19-ita-andamento-nazionale.csv")
# covid x province
covid_itpro <- read.csv("https://raw.githubusercontent.com/pcm-dpc/COVID-19/master/dati-province/dpc-covid19-ita-province.csv")
covid_italy %<>%
mutate(data = date(data)) %>%
mutate(regione = as.character(denominazione_regione))  %>%
select(-denominazione_regione,
-stato,
-codice_regione,
-lat,
-long,
-note_it,
-note_en) %>%
mutate(regione = ifelse(.$regione == "Trento","Trentino-Alto Adige",.$regione))%>%
mutate( regione = ifelse(.$regione == "Bolzano","Trentino-Alto Adige",.$regione)) %>%
mutate(regione = ifelse(.$regione == "P.A. Trento","Trentino-Alto Adige",.$regione))%>%
mutate( regione = ifelse(.$regione == "P.A. Bolzano","Trentino-Alto Adige",.$regione)) %>%
group_by(regione,data) %>%
summarize_all(~sum(.))  %>%
ungroup(regione) %>%
arrange(desc(data),desc(totale_casi))
