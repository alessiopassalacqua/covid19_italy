filter(regione %in%
c("Abruzzo", "Molise", "Campania", "Puglia",
"Basilicata", "Calabria","Sicilia","Sardegna")) %>%
select(-regione) %>%
group_by(data) %>%
summarise(totale_sud_isole = sum(totale_casi)) %>%
mutate(nuovi_casi_si = totale_sud_isole - lag(totale_sud_isole))
covid_sud_isole %>%
ggplot(aes(data,nuovi_casi_si)) + geom_line()
covid_byregion <-
covid_nord_ovest %>%
left_join(covid_nord_est) %>%
left_join(covid_centro) %>%
left_join(covid_sud_isole) %>%
select(data,nuovi_casi_no,nuovi_casi_ne,nuovi_casi_si,nuovi_casi_ce)
library(tidyr)
library(scales)
library(ggpubr)
library("RColorBrewer")
text_no <-     paste("Nord Overst: Piemonte, Valle d'Aosta, Liguria, Lombardia")
text_ne <-     paste("Nord Est: Trentino-Alto Adige, Veneto, Friuli Venezia Giulia, Emilia-Romagna")
text_centro <- paste("Centro: Toscana, Umbria, Marche, Lazio")
text_si <-     paste("Sud e Isole: Abruzzo, Molise, Campania, Puglia, Basilicata, Calabria, Sicilia, Sardegna")
covid_byregion_gather <-
covid_byregion %>%
gather(gr,nuovi_casi,-data)  %>%
mutate(gr = as.factor(gr))
#Create a custom color scale
library(RColorBrewer)
myColors <- brewer.pal(4,"Set1")
names(myColors) <- levels(covid_byregion_gather$gr)
colScale <- scale_colour_manual(name = "grp",values = myColors)
# "#E41A1C" centro
# "#377EB8"  nord-est
# "#4DAF4A" nord-ovest
# "#984EA3" sud isole
covid_byregion_gather %>%
ggplot(aes(x=data,y=nuovi_casi,colour=gr)) +
#-- color
colScale +
#--
geom_point(aes(colour=gr),size=1.2, alpha=0.5)  +
geom_smooth(se=F) +
scale_y_continuous(label = comma_format(big.mark = ".", decimal.mark = ",")  ) +
#-- Annotate Nord ovest
annotate("text", x = ymd("2020-03-6"), y =4000, label = text_no,size=3)   +
geom_label( aes( x=ymd("2020-03-18"), y=2800, label="Nord-Ovest"),
color="#4DAF4A",
size=5 , fontface="bold" )+
#-- Annotate Nord est
annotate("text", x = ymd("2020-03-6"), y =3800, label = text_ne,size=3)   +
geom_label( aes( x=ymd("2020-03-20"), y=1400, label="Nord-Est"),
color="#377EB8",
size=5 , fontface="bold" )+
#-- Annotate Centro
annotate("text", x = ymd("2020-03-3"), y =3600, label = text_centro,size=3)   +
geom_label( aes( x=ymd("2020-03-21"), y=900, label="Centro"),
color="#E41A1C",
size=5 , fontface="bold" )+
#-- Annotate Sud Isole
annotate("text", x = ymd("2020-03-6"), y =3400, label = text_si,size=3)   +
geom_label( aes( x=ymd("2020-03-22"), y=200, label="Sud ed Isole"),
color="#984EA3",
size=5 , fontface="bold" )+
#-- #iorestoacasa
labs(title = "Crescita nuovi contagiati Coronavirus per zone d'Italia",
subtitle = paste0("Aggiornamento del ", Sys.Date()),
caption = "Dati: Protezione Civile",
x = "",
y = "Nuovi Casi") +
theme(legend.position = "none")
covid_nord_est <-
covid_italy %>%
filter(regione %in%
c("Trentino-Alto Adige", "Veneto", "Friuli Venezia Giulia", "Emilia-Romagna")) %>%
select(-regione) %>%
group_by(data) %>%
summarise(totale_nord_est = sum(totale_casi)) %>%
mutate(nuovi_casi_ne = totale_nord_est - lag(totale_nord_est))
covid_nord_est %>%
ggplot(aes(data,nuovi_casi_ne)) + geom_line()
knitr::opts_chunk$set(warning=FALSE, message=FALSE)
library(dplyr)
library(lubridate)
library(ggplot2)
library(magrittr)
theme_set(theme_bw())
covid_italy <- read.csv("https://raw.githubusercontent.com/pcm-dpc/COVID-19/master/dati-regioni/dpc-covid19-ita-regioni.csv")
covid_italy %>%
glimpse()
covid_italy %<>%
mutate(data = date(data)) %>%
mutate(regione = as.character(denominazione_regione))  %>%
select(-denominazione_regione,
-stato,
-codice_regione,
-lat,
-long,
-note_it,
-note_en) %>%
mutate(regione = ifelse(.$regione == "Trento","Trentino-Alto Adige",.$regione))%>%
mutate( regione = ifelse(.$regione == "Bolzano","Trentino-Alto Adige",.$regione)) %>%
mutate(regione = ifelse(.$regione == "P.A. Trento","Trentino-Alto Adige",.$regione))%>%
mutate( regione = ifelse(.$regione == "P.A. Bolzano","Trentino-Alto Adige",.$regione)) %>%
group_by(regione,data) %>%
summarize_all(~sum(.))  %>%
ungroup(regione) %>%
arrange(desc(data),desc(totale_casi))
covid_nord_ovest <-
covid_italy %>%
filter(regione %in%
c("Piemonte", "Valle d'Aosta", "Liguria", "Lombardia")) %>%
select(-regione) %>%
group_by(data) %>%
summarise(totale_nord_ovest = sum(totale_casi)) %>%
mutate(nuovi_casi_no = totale_nord_ovest - lag(totale_nord_ovest))
covid_nord_ovest %>%
ggplot(aes(data,nuovi_casi_no)) + geom_line()
covid_nord_est <-
covid_italy %>%
filter(regione %in%
c("Trentino-Alto Adige", "Veneto", "Friuli Venezia Giulia", "Emilia-Romagna")) %>%
select(-regione) %>%
group_by(data) %>%
summarise(totale_nord_est = sum(totale_casi)) %>%
mutate(nuovi_casi_ne = totale_nord_est - lag(totale_nord_est))
covid_nord_est %>%
ggplot(aes(data,nuovi_casi_ne)) + geom_line()
covid_centro <-
covid_italy %>%
filter(regione %in%
c("Toscana", "Umbria", "Marche", "Lazio")) %>%
select(-regione) %>%
group_by(data) %>%
summarise(totale_centro = sum(totale_casi)) %>%
mutate(nuovi_casi_ce = totale_centro - lag(totale_centro))
covid_centro %>%
ggplot(aes(data,nuovi_casi_ce)) + geom_line()
covid_sud_isole <-
covid_italy %>%
filter(regione %in%
c("Abruzzo", "Molise", "Campania", "Puglia",
"Basilicata", "Calabria","Sicilia","Sardegna")) %>%
select(-regione) %>%
group_by(data) %>%
summarise(totale_sud_isole = sum(totale_casi)) %>%
mutate(nuovi_casi_si = totale_sud_isole - lag(totale_sud_isole))
covid_sud_isole %>%
ggplot(aes(data,nuovi_casi_si)) + geom_line()
covid_byregion <-
covid_nord_ovest %>%
left_join(covid_nord_est) %>%
left_join(covid_centro) %>%
left_join(covid_sud_isole) %>%
select(data,nuovi_casi_no,nuovi_casi_ne,nuovi_casi_si,nuovi_casi_ce)
library(tidyr)
library(scales)
library(ggpubr)
library("RColorBrewer")
text_no <-     paste("Nord Overst: Piemonte, Valle d'Aosta, Liguria, Lombardia")
text_ne <-     paste("Nord Est: Trentino-Alto Adige, Veneto, Friuli Venezia Giulia, Emilia-Romagna")
text_centro <- paste("Centro: Toscana, Umbria, Marche, Lazio")
text_si <-     paste("Sud e Isole: Abruzzo, Molise, Campania, Puglia, Basilicata, Calabria, Sicilia, Sardegna")
covid_byregion_gather <-
covid_byregion %>%
gather(gr,nuovi_casi,-data)  %>%
mutate(gr = as.factor(gr))
#Create a custom color scale
library(RColorBrewer)
myColors <- brewer.pal(4,"Set1")
names(myColors) <- levels(covid_byregion_gather$gr)
colScale <- scale_colour_manual(name = "grp",values = myColors)
# "#E41A1C" centro
# "#377EB8"  nord-est
# "#4DAF4A" nord-ovest
# "#984EA3" sud isole
covid_byregion_gather %>%
ggplot(aes(x=data,y=nuovi_casi,colour=gr)) +
#-- color
colScale +
#--
geom_point(aes(colour=gr),size=1.2, alpha=0.5)  +
geom_smooth(se=F) +
scale_y_continuous(label = comma_format(big.mark = ".", decimal.mark = ",")  ) +
#-- Annotate Nord ovest
annotate("text", x = ymd("2020-03-6"), y =4000, label = text_no,size=3)   +
geom_label( aes( x=ymd("2020-03-18"), y=2800, label="Nord-Ovest"),
color="#4DAF4A",
size=5 , fontface="bold" )+
#-- Annotate Nord est
annotate("text", x = ymd("2020-03-6"), y =3800, label = text_ne,size=3)   +
geom_label( aes( x=ymd("2020-03-20"), y=1400, label="Nord-Est"),
color="#377EB8",
size=5 , fontface="bold" )+
#-- Annotate Centro
annotate("text", x = ymd("2020-03-3"), y =3600, label = text_centro,size=3)   +
geom_label( aes( x=ymd("2020-03-21"), y=900, label="Centro"),
color="#E41A1C",
size=5 , fontface="bold" )+
#-- Annotate Sud Isole
annotate("text", x = ymd("2020-03-6"), y =3400, label = text_si,size=3)   +
geom_label( aes( x=ymd("2020-03-22"), y=200, label="Sud ed Isole"),
color="#984EA3",
size=5 , fontface="bold" )+
#-- #iorestoacasa
labs(title = "Crescita nuovi contagiati Coronavirus per zone d'Italia",
subtitle = paste0("Aggiornamento del ", Sys.Date()),
caption = "Dati: Protezione Civile",
x = "",
y = "Nuovi Casi") +
theme(legend.position = "none")
library(tidyr)
library(scales)
library(ggpubr)
library("RColorBrewer")
text_no <-     paste("Nord Overst: Piemonte, Valle d'Aosta, Liguria, Lombardia")
text_ne <-     paste("Nord Est: Trentino-Alto Adige, Veneto, Friuli Venezia Giulia, Emilia-Romagna")
text_centro <- paste("Centro: Toscana, Umbria, Marche, Lazio")
text_si <-     paste("Sud e Isole: Abruzzo, Molise, Campania, Puglia, Basilicata, Calabria, Sicilia, Sardegna")
covid_byregion_gather <-
covid_byregion %>%
gather(gr,nuovi_casi,-data)  %>%
mutate(gr = as.factor(gr))
#Create a custom color scale
library(RColorBrewer)
myColors <- brewer.pal(4,"Set1")
names(myColors) <- levels(covid_byregion_gather$gr)
colScale <- scale_colour_manual(name = "grp",values = myColors)
# "#E41A1C" centro
# "#377EB8"  nord-est
# "#4DAF4A" nord-ovest
# "#984EA3" sud isole
covid_byregion_gather %>%
ggplot(aes(x=data,y=nuovi_casi,colour=gr)) +
#-- color
colScale +
#--
geom_point(aes(colour=gr),size=1.2, alpha=0.5)  +
geom_smooth(se=F) +
scale_y_continuous(label = comma_format(big.mark = ".", decimal.mark = ",")  ) +
#-- Annotate Nord ovest
annotate("text", x = ymd("2020-03-6"), y =4000, label = text_no,size=3)   +
geom_label( aes( x=ymd("2020-03-18"), y=2800, label="Nord-Ovest"),
color="#4DAF4A",
size=5 , fontface="bold" )+
#-- Annotate Nord est
annotate("text", x = ymd("2020-03-6"), y =3800, label = text_ne,size=3)   +
geom_label( aes( x=ymd("2020-03-20"), y=1400, label="Nord-Est"),
color="#377EB8",
size=5 , fontface="bold" )+
#-- Annotate Centro
annotate("text", x = ymd("2020-03-3"), y =3600, label = text_centro,size=3)   +
geom_label( aes( x=ymd("2020-03-21"), y=900, label="Centro"),
color="#E41A1C",
size=5 , fontface="bold" )+
#-- Annotate Sud Isole
annotate("text", x = ymd("2020-03-6"), y =3400, label = text_si,size=3)   +
geom_label( aes( x=ymd("2020-03-23"), y=200, label="Sud ed Isole"),
color="#984EA3",
size=5 , fontface="bold" )+
#-- #iorestoacasa
labs(title = "Crescita nuovi contagiati Coronavirus per zone d'Italia",
subtitle = paste0("Aggiornamento del ", Sys.Date()),
caption = "Dati: Protezione Civile",
x = "",
y = "Nuovi Casi") +
theme(legend.position = "none")
library(tidyr)
library(scales)
library(ggpubr)
library("RColorBrewer")
text_no <-     paste("Nord Overst: Piemonte, Valle d'Aosta, Liguria, Lombardia")
text_ne <-     paste("Nord Est: Trentino-Alto Adige, Veneto, Friuli Venezia Giulia, Emilia-Romagna")
text_centro <- paste("Centro: Toscana, Umbria, Marche, Lazio")
text_si <-     paste("Sud e Isole: Abruzzo, Molise, Campania, Puglia, Basilicata, Calabria, Sicilia, Sardegna")
covid_byregion_gather <-
covid_byregion %>%
gather(gr,nuovi_casi,-data)  %>%
mutate(gr = as.factor(gr))
#Create a custom color scale
library(RColorBrewer)
myColors <- brewer.pal(4,"Set1")
names(myColors) <- levels(covid_byregion_gather$gr)
colScale <- scale_colour_manual(name = "grp",values = myColors)
# "#E41A1C" centro
# "#377EB8"  nord-est
# "#4DAF4A" nord-ovest
# "#984EA3" sud isole
covid_byregion_gather %>%
ggplot(aes(x=data,y=nuovi_casi,colour=gr)) +
#-- color
colScale +
#--
geom_point(aes(colour=gr),size=1.2, alpha=0.5)  +
geom_smooth(se=F) +
scale_y_continuous(label = comma_format(big.mark = ".", decimal.mark = ",")  ) +
#-- Annotate Nord ovest
annotate("text", x = ymd("2020-03-6"), y =4000, label = text_no,size=3)   +
geom_label( aes( x=ymd("2020-03-18"), y=2800, label="Nord-Ovest"),
color="#4DAF4A",
size=5 , fontface="bold" )+
#-- Annotate Nord est
annotate("text", x = ymd("2020-03-6"), y =3800, label = text_ne,size=3)   +
geom_label( aes( x=ymd("2020-03-20"), y=1400, label="Nord-Est"),
color="#377EB8",
size=5 , fontface="bold" )+
#-- Annotate Centro
annotate("text", x = ymd("2020-03-3"), y =3600, label = text_centro,size=3)   +
geom_label( aes( x=ymd("2020-03-21"), y=900, label="Centro"),
color="#E41A1C",
size=5 , fontface="bold" )+
#-- Annotate Sud Isole
annotate("text", x = ymd("2020-03-6"), y =3400, label = text_si,size=3)   +
geom_label( aes( x=ymd("2020-03-24"), y=200, label="Sud ed Isole"),
color="#984EA3",
size=5 , fontface="bold" )+
#-- #iorestoacasa
labs(title = "Crescita nuovi contagiati Coronavirus per zone d'Italia",
subtitle = paste0("Aggiornamento del ", Sys.Date()),
caption = "Dati: Protezione Civile",
x = "",
y = "Nuovi Casi") +
theme(legend.position = "none")
library(tidyr)
library(scales)
library(ggpubr)
library("RColorBrewer")
text_no <-     paste("Nord Overst: Piemonte, Valle d'Aosta, Liguria, Lombardia")
text_ne <-     paste("Nord Est: Trentino-Alto Adige, Veneto, Friuli Venezia Giulia, Emilia-Romagna")
text_centro <- paste("Centro: Toscana, Umbria, Marche, Lazio")
text_si <-     paste("Sud e Isole: Abruzzo, Molise, Campania, Puglia, Basilicata, Calabria, Sicilia, Sardegna")
covid_byregion_gather <-
covid_byregion %>%
gather(gr,nuovi_casi,-data)  %>%
mutate(gr = as.factor(gr))
#Create a custom color scale
library(RColorBrewer)
myColors <- brewer.pal(4,"Set1")
names(myColors) <- levels(covid_byregion_gather$gr)
colScale <- scale_colour_manual(name = "grp",values = myColors)
# "#E41A1C" centro
# "#377EB8"  nord-est
# "#4DAF4A" nord-ovest
# "#984EA3" sud isole
covid_byregion_gather %>%
ggplot(aes(x=data,y=nuovi_casi,colour=gr)) +
#-- color
colScale +
#--
geom_point(aes(colour=gr),size=1.2, alpha=0.5)  +
geom_smooth(se=F) +
scale_y_continuous(label = comma_format(big.mark = ".", decimal.mark = ",")  ) +
#-- Annotate Nord ovest
annotate("text", x = ymd("2020-03-6"), y =4000, label = text_no,size=3)   +
geom_label( aes( x=ymd("2020-03-18"), y=2800, label="Nord-Ovest"),
color="#4DAF4A",
size=5 , fontface="bold" )+
#-- Annotate Nord est
annotate("text", x = ymd("2020-03-6"), y =3800, label = text_ne,size=3)   +
geom_label( aes( x=ymd("2020-03-20"), y=1400, label="Nord-Est"),
color="#377EB8",
size=5 , fontface="bold" )+
#-- Annotate Centro
annotate("text", x = ymd("2020-03-3"), y =3600, label = text_centro,size=3)   +
geom_label( aes( x=ymd("2020-03-21"), y=900, label="Centro"),
color="#E41A1C",
size=5 , fontface="bold" )+
#-- Annotate Sud Isole
annotate("text", x = ymd("2020-03-6"), y =3400, label = text_si,size=3)   +
geom_label( aes( x=ymd("2020-03-26"), y=200, label="Sud ed Isole"),
color="#984EA3",
size=5 , fontface="bold" )+
#-- #iorestoacasa
labs(title = "Crescita nuovi contagiati Coronavirus per zone d'Italia",
subtitle = paste0("Aggiornamento del ", Sys.Date()),
caption = "Dati: Protezione Civile",
x = "",
y = "Nuovi Casi") +
theme(legend.position = "none")
library(tidyr)
library(scales)
library(ggpubr)
library("RColorBrewer")
text_no <-     paste("Nord Overst: Piemonte, Valle d'Aosta, Liguria, Lombardia")
text_ne <-     paste("Nord Est: Trentino-Alto Adige, Veneto, Friuli Venezia Giulia, Emilia-Romagna")
text_centro <- paste("Centro: Toscana, Umbria, Marche, Lazio")
text_si <-     paste("Sud e Isole: Abruzzo, Molise, Campania, Puglia, Basilicata, Calabria, Sicilia, Sardegna")
covid_byregion_gather <-
covid_byregion %>%
gather(gr,nuovi_casi,-data)  %>%
mutate(gr = as.factor(gr))
#Create a custom color scale
library(RColorBrewer)
myColors <- brewer.pal(4,"Set1")
names(myColors) <- levels(covid_byregion_gather$gr)
colScale <- scale_colour_manual(name = "grp",values = myColors)
# "#E41A1C" centro
# "#377EB8"  nord-est
# "#4DAF4A" nord-ovest
# "#984EA3" sud isole
covid_byregion_gather %>%
ggplot(aes(x=data,y=nuovi_casi,colour=gr)) +
#-- color
colScale +
#--
geom_point(aes(colour=gr),size=1.2, alpha=0.5)  +
geom_smooth(se=F) +
scale_y_continuous(label = comma_format(big.mark = ".", decimal.mark = ",")  ) +
#-- Annotate Nord ovest
annotate("text", x = ymd("2020-03-6"), y =4000, label = text_no,size=3)   +
geom_label( aes( x=ymd("2020-03-18"), y=2800, label="Nord-Ovest"),
color="#4DAF4A",
size=5 , fontface="bold" )+
#-- Annotate Nord est
annotate("text", x = ymd("2020-03-6"), y =3800, label = text_ne,size=3)   +
geom_label( aes( x=ymd("2020-03-20"), y=1400, label="Nord-Est"),
color="#377EB8",
size=5 , fontface="bold" )+
#-- Annotate Centro
annotate("text", x = ymd("2020-03-3"), y =3600, label = text_centro,size=3)   +
geom_label( aes( x=ymd("2020-03-21"), y=900, label="Centro"),
color="#E41A1C",
size=5 , fontface="bold" )+
#-- Annotate Sud Isole
annotate("text", x = ymd("2020-03-8"), y =3400, label = text_si,size=3)   +
geom_label( aes( x=ymd("2020-03-23"), y=200, label="Sud ed Isole"),
color="#984EA3",
size=5 , fontface="bold" )+
#-- #iorestoacasa
labs(title = "Crescita nuovi contagiati Coronavirus per zone d'Italia",
subtitle = paste0("Aggiornamento del ", Sys.Date()),
caption = "Dati: Protezione Civile",
x = "",
y = "Nuovi Casi") +
theme(legend.position = "none")
knitr::opts_chunk$set(warning=FALSE, message=FALSE)
library(dplyr)
library(drc)
library(lubridate)
library(ggplot2)
library(scales)
theme_set(theme_bw())
# get the data
covid_italy_sum <- read.csv("https://raw.githubusercontent.com/pcm-dpc/COVID-19/master/dati-andamento-nazionale/dpc-covid19-ita-andamento-nazionale.csv")
maxrange <- 50
x <-  1:maxrange
nn <- 0   # test
cov_tot <-  rep(NA,maxrange)
gg <-  length(covid_italy_sum$totale_casi)
cov_tot[1:(gg-nn)]    <- covid_italy_sum$totale_casi[1:(gg-nn)]
xy <- data.frame(x=x,y=cov_tot)
# fitting logistico
model <- drm(y ~ x, fct = L.3(), data = xy[1:(gg-nn),])
summary(model)
# prediction
xy_fit <-
predict(model,xy,interval = 'confidence')  %>%
as.data.frame()
# plot fitting
nomodel <- rep(NA,maxrange)
nomodel[(gg-nn+1):gg] <- covid_italy_sum$totale_casi[(gg-nn+1):gg]
y_text <- 40000
nuovicasi <- rep(NA,maxrange)
nuovicasi[1:gg] <- (covid_italy_sum$totale_casi - lag( covid_italy_sum$totale_casi ) )*10
ggplot(xy_fit,aes(x=1:maxrange,y=Prediction))  +
geom_line() +
geom_point(colour="blue",aes(y=xy$y)) +
#  geom_point(colour="red",aes(y=nomodel),shape=15,size=2) +
geom_line(aes(y = Lower), color = "red", linetype = "dashed")+
geom_line(aes(y = Upper), color = "red", linetype = "dashed")+
geom_line(aes(y = nuovicasi),color = 'orange', alpha = .5) +
geom_area(aes(y = nuovicasi),fill = 'orange', alpha = .05) +
#-- ITALY
annotate(geom = "text", x = 5, y = 74000+y_text,
label = "Training data", hjust = 0) +
annotate("pointrange", x = 3.5, y = 74000+y_text, ymin = 73500+y_text,
ymax = 73500+y_text,colour = "blue", size = 0.7)+
#-- FIT
annotate(geom = "text", x = 5, y = 67000+y_text,
label = "Fit logistico", hjust = 0) +
annotate(geom = "segment", x = 2.5,xend = 4,
y = 67000+y_text,yend=67000+y_text) +
#-- CONF
annotate(geom = "text", x = 5, y = 60000+y_text,
label = "Intervallo di confidenza 95%", hjust = 0) +
annotate(geom = "segment", x = 2.5,xend = 3,
y = 60000+y_text,yend=60000+y_text, colour="red") +
annotate(geom = "segment", x = 3.5,xend = 4,
y = 60000+y_text,yend=60000+y_text, colour="red") +
#-- NUOVI CASI
annotate(geom = "text", x = 5, y = 53000+y_text,
label = "Nuovi Casi", hjust = 0) +
annotate(geom = "segment", x = 2.5,xend = 4,
y = 53000+y_text,yend=53000+y_text,color="orange",size=1.1) +
#-- Test
#  annotate(geom = "text", x = 5, y = 46000+y_text,
#           label = "Test data", hjust = 0) +
#  annotate(geom="rect",xmin=3, xmax=3.6, ymin=44000+y_text , ymax=47000+y_text, color="red", fill="red") +
#-- Restoacasa
geom_label( aes( x=42, y=10000, label="#iorestoacasa"),
color="black",
size=5 , fontface="bold" )+
scale_y_continuous(
label = comma_format(big.mark = ".", decimal.mark = ","),
"Totale Positivi",
sec.axis = sec_axis(~ . / 10, name = "Nuovi casi")  ) +
#-- #iorestoacasa
labs(title = "Crescita contagiati Coronavirus Italia ",
subtitle = paste0("Previsione curva di crescita - Aggiornamento del ", Sys.Date() ),
caption = "Dati: Protezione Civile",
x = "Giorni (giorno 1 = 24 Febbraio)",
y = "Totale Positivi")
